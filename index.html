<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contrato Profesional Interactivo - Versión Definitiva</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibVdQVQqzDCRtCoKFSLEtiQMlaRBTW2A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" xintegrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --rojo-claro: #ef4444;
            --gris-texto: #374151;
            --gris-borde: #d1d5db;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        #contrato-container {
            font-size: 14px;
        }
        .form-input-line {
            border: none;
            border-bottom: 1px solid var(--gris-borde);
            border-radius: 0;
            padding: 0.25rem;
            background-color: transparent;
            transition: border-color 0.2s;
            width: 100%;
        }
        .form-input-line:focus {
            outline: none;
            border-bottom-color: var(--rojo-claro);
        }
        .custom-checkbox {
            appearance: none;
            background-color: #fff;
            border: 1px solid var(--gris-borde);
            width: 1.15rem;
            height: 1.15rem;
            border-radius: 0.25rem;
            display: inline-block;
            position: relative;
            vertical-align: middle;
            cursor: pointer;
            flex-shrink: 0;
        }
        .custom-checkbox:checked {
            background-color: var(--rojo-claro);
            border-color: var(--rojo-claro);
        }
        .custom-checkbox:checked::after {
            content: '✔';
            font-size: 0.75rem;
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .section-header {
            background-color: #e5e7eb;
            color: var(--gris-texto);
            padding: 0.5rem 1rem;
            font-weight: 700;
            text-align: center;
            border-radius: 0.375rem;
            margin: 2.5rem 0 1.5rem 0;
        }
        .anexo-header {
            text-align: center;
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--gris-texto);
            margin-bottom: 1rem;
        }
        .anexo-section-title {
            text-align: center;
            font-weight: 700;
            color: var(--gris-texto);
            border-top: 1px solid #000;
            border-bottom: 1px solid #000;
            padding: 0.25rem 0;
            margin: 1.5rem 0;
        }
        .action-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background-color: #3b82f6;
            color: white;
            font-weight: 600;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }
        .action-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .export-button { background-color: #16a34a; }
        .export-button:hover { background-color: #15803d; }
        .image-export-button { background-color: #0ea5e9; }
        .image-export-button:hover { background-color: #0284c7; }
        .gemini-button { background-color: #8b5cf6; }
        .gemini-button:hover { background-color: #7c3aed; }
        .delete-btn {
            color: #9ca3af;
            cursor: pointer;
            font-weight: bold;
        }
        .delete-btn:hover {
            color: var(--rojo-claro);
        }
        .editable-table thead th {
            font-weight: 600;
            text-align: center;
            background-color: var(--rojo-claro);
            color: white;
            padding: 0.75rem;
        }
        .editable-table td {
            border: 1px solid var(--gris-borde);
            padding: 0.5rem;
            position: relative;
        }
        .editable-table td[contenteditable="true"]:focus {
            background-color: #fee2e2;
            outline: 2px solid var(--rojo-claro);
            z-index: 10;
        }
        .pdf-page {
            page-break-after: always;
        }
        .pdf-page:last-child {
            page-break-after: auto;
        }
        #gemini-modal {
            transition: opacity 0.3s ease;
        }
        @media print {
            .no-print { display: none !important; }
            body, #contrato-container { background-color: #fff !important; box-shadow: none !important; margin: 0 !important; padding: 0 !important; max-width: 100% !important; }
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="max-w-5xl mx-auto">
        <div class="mb-6 flex flex-wrap gap-2 justify-end no-print">
            <button id="gemini-summarize-btn" class="action-button gemini-button text-xs sm:text-sm">✨ Resumir con IA</button>
            <button id="export-pdf-btn" class="action-button export-button text-xs sm:text-sm">Exportar a PDF</button>
            <button id="export-img-btn" class="action-button image-export-button text-xs sm:text-sm">Exportar a Imagen</button>
        </div>
        
        <main id="contrato-container" class="bg-white p-6 sm:p-10 rounded-xl shadow-2xl">
            
            <div class="pdf-page">
                <section class="mb-10">
                    <div class="flex justify-between items-center border-b-2 border-red-500 pb-2 mb-4">
                        <h2 class="text-xl font-extrabold text-gray-800">CASO PRÁCTICO</h2>
                        <button id="gemini-suggest-btn" class="action-button gemini-button no-print">
                           ✨<span id="gemini-btn-text" class="ml-1">Sugerir</span>
                        </button>
                    </div>
                    <div id="caso-practico-content" contenteditable="true" class="w-full min-h-[120px] p-4 bg-gray-50 rounded-lg border border-gray-200 text-gray-600 focus:outline-none focus:ring-2 focus:ring-red-300" placeholder="Describe aquí el caso práctico o presiona 'Sugerir' para que la IA genere uno.">
                    </div>
                </section>
                <header class="flex flex-col sm:flex-row justify-between items-start pb-4 border-b-2 border-gray-100 mb-8">
                    <h1 class="text-xl font-extrabold text-gray-800 w-full sm:w-2/3 mb-4 sm:mb-0">CONTRATO DE SERVICIOS DE TELECOMUNICACIONES</h1>
                    <div class="text-left sm:text-right flex-shrink-0 w-full sm:w-auto">
                        <img src="https://www.claro.com.ni/wp-content/themes/claro-home/images/logo-claro.svg" alt="Logo Claro" class="h-8 sm:ml-auto">
                        <p class="text-xs text-gray-500 mt-1">Claro que sí</p>
                        <div class="flex items-center gap-2 mt-4">
                            <label for="contract-no" class="font-bold">Nº</label>
                            <input type="text" id="contract-no" value="08552" class="w-24 p-2 border border-gray-300 rounded-md text-center font-semibold">
                        </div>
                    </div>
                </header>
                <section class="mb-6 text-gray-700">
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-28 mb-1 sm:mb-0">No. Solicitud:</label><input type="text" id="solicitud" class="form-input-line flex-1"></div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-36 mb-1 sm:mb-0">Ejec./canal de venta:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="hidden md:block"></div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-12 mb-1 sm:mb-0">Fecha:</label><input type="date" class="form-input-line flex-1"></div>
                    </div>
                    <p class="my-4 p-4 bg-gray-50 rounded-lg">El (la) suscrito (a) <input type="text" class="form-input-line inline-block w-full"> en representación de ENITEL, y Nombre Completo o Razón Social <input type="text" id="nombre-cliente" class="form-input-line inline-block w-full"> en adelante "EL CLIENTE".</p>
                    <div class="grid grid-cols-1 gap-y-4">
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-52 mb-1 sm:mb-0">Nombre del Representante de EL CLIENTE:</label><input type="text" class="form-input-line flex-1"></div>
                         <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-4">
                            <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-28 mb-1 sm:mb-0">Identificación:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-28 mb-1 sm:mb-0">No. Cliente:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-36 mb-1 sm:mb-0">Teléfono de contacto:</label><input type="tel" class="form-input-line flex-1"></div>
                            <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-28 mb-1 sm:mb-0">Celular:</label><input type="tel" class="form-input-line flex-1"></div>
                         </div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-28 mb-1 sm:mb-0">Email:</label><input type="email" class="form-input-line flex-1"></div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-28 mb-1 sm:mb-0">Municipio:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-44 mb-1 sm:mb-0">Dirección de Facturación: Física:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-44 mb-1 sm:mb-0">Electrónica:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="field-group flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-44 mb-1 sm:mb-0">Dirección de Instalación:</label><input type="text" class="form-input-line flex-1"></div>
                    </div>
                    <p class="mt-4">Convienen en suscribir el presente contrato de servicios de telecomunicaciones:</p>
                </section>
                <div class="section-header">I. SERVICIOS CONTRATADOS</div>
                <section class="grid grid-cols-1 md:grid-cols-2 gap-x-8 mb-6">
                    <div class="space-y-4">
                        <div><label class="font-bold">Telefonía Básica:</label><input type="text" class="form-input-line w-full"></div>
                        <div><label class="font-bold">Televisión por Suscripción:</label><input type="text" class="form-input-line w-full"></div>
                        <div><label class="font-bold">Acceso a Internet Fijo</label><br><label class="ml-2">Velocidad hasta:</label><input type="text" class="form-input-line w-full"></div>
                        <div><label class="font-bold">Acceso a Internet Móvil</label><br><label class="ml-2">Cantidad de descarga:</label><input type="text" class="form-input-line w-full"><p class="text-xs text-gray-500 ml-2">(Para servicios de internet móviles la velocidad está sujeta a la red)</p></div>
                    </div>
                     <div class="space-y-4 mt-4 md:mt-0">
                        <div><label class="font-bold">Telefonía Móvil Celular:</label><br><label class="ml-2">Plan:</label><input type="text" class="form-input-line w-full"><label class="ml-2 mt-2 inline-block">Roaming:</label><input type="text" class="form-input-line w-full"></div>
                        <div><label class="font-bold">Televisión Satelital:</label><input type="text" class="form-input-line w-full"></div>
                        <div><label class="font-bold">Contrato en modalidad:</label>
                            <div class="ml-2 mt-2 space-y-2">
                                <p>a. Servicios en Combo</p>
                                <div class="flex items-center space-x-4 ml-4"><label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Doble</label><label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Triple</label><label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Cuadruple</label></div>
                                <div class="ml-4 flex items-center flex-wrap gap-x-4 gap-y-2">Servicios en Combo: 
                                    <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">LF</label>
                                    <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">TV</label>
                                    <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">AI</label>
                                </div>
                                <p class="ml-4 flex items-center gap-2">Otro: <input type="text" class="form-input-line w-3/4"></p>
                                <p>b. <label class="ml-2 flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Domiciliar</label><label class="ml-4 flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Empresarial</label></p>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="mb-6">
                    <div class="border rounded-lg p-3">
                        <label class="font-bold">Servicios de valor agregado:</label>
                        <div class="mt-2 h-20" contenteditable="true"></div>
                    </div>
                </section>
                <section class="mb-6">
                     <div class="overflow-x-auto rounded-lg shadow-sm border border-gray-200">
                        <table id="servicios-table" class="w-full editable-table">
                            <thead>
                                <tr><th>Servicio</th><th>Costo</th><th>Vigencia</th><th class="w-12 no-print"></th></tr>
                            </thead>
                            <tbody>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                            </tbody>
                        </table>
                     </div>
                     <button onclick="addRow('servicios-table')" class="action-button mt-4 text-xs no-print">Añadir Fila</button>
                </section>
            </div>

            <div class="pdf-page">
                <div class="section-header">II. EQUIPOS</div>
                <section class="mb-6 space-y-4">
                    <div class="flex items-center space-x-8"><label class="font-bold">Equipo entregado en calidad de</label><label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Comodato</label><label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Otro</label></div>
                    <div><label class="font-bold w-32 inline-block">Valor del Equipo:</label><input type="text" class="form-input-line w-full md:w-3/4"></div>
                    <div class="border rounded-lg p-3 mt-2"><label class="font-bold">Especificación:</label><div class="mt-2 h-24" contenteditable="true"></div></div>
                    <div class="border rounded-lg p-3 mt-2"><label class="font-bold">Equipo asociado al servicio:</label><div class="mt-2 h-32" contenteditable="true"></div></div>
                </section>
                <div class="section-header">III. TARIFAS Y CARGO</div>
                 <section class="mb-6">
                    <div class="overflow-x-auto rounded-lg shadow-sm border border-gray-200">
                        <table id="tarifas-table" class="w-full editable-table">
                            <thead>
                                <tr><th>Servicios</th><th>Tarifas (US$) antes de IVA</th><th>Forma de Pago (Única o mensual)</th><th class="w-12 no-print"></th></tr>
                            </thead>
                            <tbody>
                                <tr><td class="bg-gray-50 font-medium">Servicios contratados</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Servicios en combo</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Servicios de valor agregado</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Instalación / activación</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Equipos (prima)</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Equipos (mensualidad)</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Otros</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">Depósito en garantía</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr><td class="bg-gray-50 font-medium">servicios post pago</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="text-center bg-gray-50 no-print"><span class="delete-btn" onclick="deleteRow(this)">&times;</span></td></tr>
                                <tr class="bg-gray-200 font-bold"><td class="p-2">TOTAL</td><td contenteditable="true"></td><td contenteditable="true"></td><td class="no-print"></td></tr>
                            </tbody>
                        </table>
                    </div>
                     <button onclick="addRow('tarifas-table')" class="action-button mt-4 text-xs no-print">Añadir Fila a Tarifas</button>
                    <div class="mt-4 space-y-3">
                        <p>Las tarifas en moneda dólar de los Estados Unidos de América, serán pagaderas en Córdobas al tipo de cambio oficial al día de la facturación. Monto total más IVA.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div class="flex flex-col"><label>Forma de pago: Débito automático:</label><input type="text" class="form-input-line w-full"></div>
                            <div class="flex flex-col"><label>Vencimiento:</label><input type="text" class="form-input-line w-full"></div>
                            <div class="sm:col-span-2 flex flex-col"><label>Otro:</label><input type="text" class="form-input-line w-full"></div>
                        </div>
                        <p>Las tarifas de roaming están sujetas al país destino. El cliente acepta los cargos correspondientes en caso de uso del servicio.</p>
                    </div>
                </section>
                <div class="section-header">IV. CONDICIONES GENERALES</div>
                <section class="mb-6 text-xs text-justify space-y-3">
                    <p>Las presentes condiciones generales serán aplicables a todos los servicios de telecomunicaciones que contrate EL CLIENTE con la EMPRESA NICARAGÜENSE DE TELECOMUNICACIONES, S.A., siempre que no sean contrarias con las condiciones específicas aplicables a cada servicio. Por acuerdo mutuo entre EL CLIENTE y ENITEL podrán pactarse condiciones adicionales siempre que estas se den de forma expresa y no sean contrarias a las disposiciones en materia de derechos de usuarias y consumidores.</p>
                    <p>Cuando existan Códigos de Prácticas Comerciales aprobados por TELCOR, estos prevalecerán o complementarán las condiciones de este contrato según corresponda a cada servicio.</p>
                </section>
            </div>
            
            <div class="pdf-page">
                <h2 class="text-2xl font-extrabold text-gray-800 border-b-2 border-red-500 pb-2 mt-8 mb-6">ANEXOS DEL CONTRATO</h2>
                <section id="anexo-1">
                    <h3 class="anexo-header">AUTORIZACIÓN PARA TRATAMIENTO DE DATOS PERSONALES<br>Y REMISIÓN DE INFORMACIÓN A CENTRALES DE RIESGOS</h3>
                    <p class="text-xs text-justify mb-4">
                        EL CLIENTE manifiesta que la información proporcionada para la contratación de los servicios es verídica y autoriza a ENITEL a consultar, verificar y solicitar en cualquier momento toda la información para conocer su desempeño crediticio en una Central de Riesgo Privada. Asimismo, le autoriza para informar, reportar o divulgar a la Central de Riesgo Privada (CRP), previamente autorizada y regulada por la Superintendencia de Bancos y Otras Instituciones Financieras (SIBOIF), toda información relevante que posea en relación a su desempeño como deudor, con el fin de que ésta la administre de forma confidencial y la suministre a terceros que cuenten con el propósito permisible debido.
                        A su vez, autoriza a ENITEL para su uso interno exclusivo, al tratamiento de sus datos personales de acuerdo a la definición descrita en la ley de Protección de Datos Personales para facilitar la mejora, ampliación, venta, facturación y prestación del (los) servicio (s) suscritos.
                    </p>
                    <div class="anexo-section-title">FIRMA DEL CLIENTE</div>
                    <div class="anexo-section-title">DATOS DEL CLIENTE</div>
                    <div class="flex flex-wrap gap-x-6 gap-y-4 mb-4">
                        <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> Cliente de la Competencia</label>
                        <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> Cliente Nuevo</label>
                        <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> Cliente Existente</label>
                        <label class="flex items-center gap-2">Nº de Contrato <input type="text" class="form-input-line w-24"></label>
                    </div>
                    <p class="mb-4">Documento de Identificación Cedula De Identidad, Numero de cedula: <input type="text" class="form-input-line w-full sm:w-1/2"></p>
                    <div class="space-y-4">
                        <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-32 mb-1 sm:mb-0">Nombre Completo:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-36 mb-1 sm:mb-0">Número de contacto 1:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-36 mb-1 sm:mb-0">Número de contacto 2:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-36 mb-1 sm:mb-0">Número de contacto 3:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-36 mb-1 sm:mb-0">Número de contacto 4:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-32 mb-1 sm:mb-0">Departamento:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-32 mb-1 sm:mb-0">Municipio:</label><input type="text" class="form-input-line flex-1"></div>
                        </div>
                        <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-56 mb-1 sm:mb-0">Barrio, Comarca, Reparto, Residencial:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-32 mb-1 sm:mb-0">Dirección:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-32 mb-1 sm:mb-0">Correo Electrónico:</label><input type="text" class="form-input-line flex-1"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                            <div class="flex flex-col sm:flex-row sm:items-center"><span class="tick-mark hidden sm:inline">&gt;</span><label class="w-full sm:w-32 mb-1 sm:mb-0">Numero Niss:</label><input type="text" class="form-input-line flex-1"></div>
                            <div class="flex flex-col sm:flex-row sm:items-center"><label class="w-full sm:w-32 mb-1 sm:mb-0">Soporte de Ingreso:</label><input type="text" class="form-input-line flex-1"></div>
                        </div>
                    </div>
                    <div class="anexo-section-title">NOMBRE DE REFERENCIAS</div>
                    <div class="space-y-3">
                        <div class="flex flex-col sm:flex-row sm:items-center gap-2">1.<input type="text" class="form-input-line flex-1" placeholder="Nombre completo"><label class="w-auto sm:w-20">Teléfono</label><input type="text" class="form-input-line w-full sm:w-1/3"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center gap-2">2.<input type="text" class="form-input-line flex-1" placeholder="Nombre completo"><label class="w-auto sm:w-20">Teléfono</label><input type="text" class="form-input-line w-full sm:w-1/3"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center gap-2">3.<input type="text" class="form-input-line flex-1" placeholder="Nombre completo"><label class="w-auto sm:w-20">Teléfono</label><input type="text" class="form-input-line w-full sm:w-1/3"></div>
                    </div>
                </section>
            </div>
            
            <div class="pdf-page">
                <section id="anexo-2" class="mt-8">
                     <h3 class="anexo-header">&#9733; SEGMENTACIÓN DEL CLIENTE</h3>
                     <div class="space-y-6">
                        <div class="p-4 border rounded-lg space-y-4">
                            <div class="flex flex-wrap items-center gap-x-4 gap-y-2"><label class="tick-mark">&#10003;</label> <label class="font-bold">Paga Deposito</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> Si</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> No</label></div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 pl-8"><label>¿Cuánto? U$<input type="text" class="form-input-line w-full"></label> <label>¿Por qué?<input type="text" class="form-input-line w-full"></label></div>
                        </div>
                        <div class="p-4 border rounded-lg space-y-4">
                             <div class="flex flex-wrap items-center gap-x-4 gap-y-2"><label class="tick-mark">&#10003;</label> <label class="font-bold">Paga Instalación</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> Si</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox"> No</label></div>
                             <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 pl-8"><label>¿Cuánto? U$<input type="text" class="form-input-line w-full"></label> <label>¿Por qué?<input type="text" class="form-input-line w-full"></label></div>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><label>Servicio:<input type="text" class="form-input-line w-full"></label><label>Renta del Servicio: U$<input type="text" class="form-input-line w-full"></label></div>
                        <div><label>Oferta comercial:</label><input type="text" class="form-input-line w-full"></div>
                        <div class="flex flex-wrap gap-x-6 gap-y-2">Extensiones: <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Análogas</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Básica Digital</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Digital Avanzado</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Satelital</label></div>
                        <div class="flex flex-wrap gap-x-6 gap-y-2">Cuentas extensiones: <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Principal</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Cortesía</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">Adicional</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">DTH</label> <label class="flex items-center gap-2"><input type="checkbox" class="custom-checkbox">otro</label></div>

                        <div class="anexo-section-title">PLATAFORMAS</div>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <label>CLARO VIDEO<input type="text" class="form-input-line w-full"></label> 
                            <label>PARAMOUNT+<input type="text" class="form-input-line w-full"></label> 
                            <label>TV EVERYWHERE<input type="text" class="form-input-line w-full"></label>
                        </div>
                        <div><label>Vigencia:</label><input type="text" class="form-input-line w-full"></div>

                        <div class="anexo-section-title">PAQUETERIA DE CANALES HBO</div>
                         <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                             <div class="flex items-center"><label class="tick-mark">&#10003;</label> <label class="w-48">PAQUETE MINI HBO MAX</label><input type="text" class="form-input-line flex-1"></div>
                             <div><label>Cortesía por</label><input type="text" class="form-input-line w-full"></div>
                         </div>
                         <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                             <div class="flex items-center"><label class="tick-mark">&#10003;</label> <label class="w-48">PAQUETE PREMIUM HBO</label><input type="text" class="form-input-line flex-1"></div>
                             <div><label>Cortesía por</label><input type="text" class="form-input-line w-full"></div>
                         </div>
                         
                        <div class="anexo-section-title">RECARGAS</div>
                         <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <label>RECARGA POR BIENVENIDA 30%</label>
                            <label>Número De Activación<input type="text" class="form-input-line w-full"></label>
                         </div>
                         <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <label>RECARGA POR PRONTO PAGO 20%</label>
                            <label>Número De Activación<input type="text" class="form-input-line w-full"></label>
                         </div>

                        <div class="anexo-section-title">NÚMEROS FAVORITOS<br><span class="text-xs font-normal">(Recuerde deben ser solicitados durante el llenado de estos datos)</span></div>
                        <div class="space-y-3">
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div class="flex items-center"><label class="tick-mark">&#10003;</label> <label class="w-24">Número 1</label><input type="text" class="form-input-line flex-1"></div><div><label>Cortesía por</label><input type="text" class="form-input-line w-full"></div></div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div class="flex items-center"><label class="tick-mark">&#10003;</label> <label class="w-24">Número 2</label><input type="text" class="form-input-line flex-1"></div><div><label>Cortesía por</label><input type="text" class="form-input-line w-full"></div></div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div class="flex items-center"><label class="tick-mark">&#10003;</label> <label class="w-24">Número 3</label><input type="text" class="form-input-line flex-1"></div><div><label>Cortesía por</label><input type="text" class="form-input-line w-full"></div></div>
                        </div>

                        <div class="pt-6 space-y-4">
                            <p>Dado en <input type="text" class="form-input-line w-32"> a los <input type="text" class="form-input-line w-16"> días del mes de <input type="text" class="form-input-line w-24"> del <input type="text" class="form-input-line w-20"></p>
                            <div><label>Observaciones:</label> <textarea class="form-input-line w-full mt-1 border rounded-md p-2" rows="3"></textarea></div>
                            <div><label>Firma del supervisor:</label><input type="text" class="form-input-line w-full"></div>
                            <div class="pt-4 grid grid-cols-1 md:grid-cols-3 gap-x-4 gap-y-4">
                                <div><label>Ejecutivo de ventas</label><input type="text" class="form-input-line w-full"></div>
                                <div><label>Código open</label><input type="text" class="form-input-line w-full"></div>
                                <div><label>Fecha</label><input type="date" class="form-input-line w-full"></div>
                            </div>
                        </div>
                    </div>
                </section>
                <footer class="text-right mt-12 pt-8 border-t-2 border-gray-100 text-sm text-gray-500">
                    ALCAZAR S.A.
                </footer>
            </div>
        </main>
    </div>
    <!-- Gemini Modal -->
    <div id="gemini-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl transform scale-95 transition-transform duration-300">
            <div class="p-6 border-b">
                <h3 class="text-xl font-bold text-gray-800">✨ Resumen del Contrato (Generado por IA)</h3>
            </div>
            <div id="gemini-summary-content" class="p-6 max-h-[60vh] overflow-y-auto">
                <p>Generando resumen...</p>
            </div>
            <div class="p-4 bg-gray-50 border-t flex justify-end">
                <button id="close-gemini-modal" class="action-button bg-red-500 hover:bg-red-600">Cerrar</button>
            </div>
        </div>
    </div>
    <script>
        // --- Gemini API Calls ---
        const suggestBtn = document.getElementById('gemini-suggest-btn');
        const summarizeBtn = document.getElementById('gemini-summarize-btn');
        const casoPracticoContent = document.getElementById('caso-practico-content');
        const modal = document.getElementById('gemini-modal');
        const modalContent = document.getElementById('gemini-summary-content');
        const closeModalBtn = document.getElementById('close-gemini-modal');

        async function callGemini(prompt) {
            const apiKey = ""; // API Key is not needed for this environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();
                if (result.candidates && result.candidates[0]?.content.parts[0]?.text) {
                    return result.candidates[0].content.parts[0].text;
                }
                return "No se pudo generar una respuesta. La estructura de la respuesta no es la esperada.";
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return `Error al contactar al asistente de IA: ${error.message}`;
            }
        }

        suggestBtn.addEventListener('click', async () => {
            const btnText = suggestBtn.querySelector('#gemini-btn-text');
            const originalText = btnText.textContent;
            btnText.textContent = 'Generando...';
            suggestBtn.disabled = true;
            const prompt = "Genera un escenario de caso práctico conciso para un contrato de servicios de telecomunicaciones de Claro en Nicaragua. Incluye nombre del cliente, número de cédula ficticio, y los servicios que desea contratar (ej: internet fibra óptica de 100Mbps, 1 línea móvil postpago con 20GB, y el paquete de TV Avanzado con HBO). Menciona que el cliente quiere aprovechar una promoción de 3 meses de Paramount+ gratis. Formatea la respuesta en un párrafo corto y claro.";
            const suggestion = await callGemini(prompt);
            casoPracticoContent.textContent = suggestion;
            btnText.textContent = originalText;
            suggestBtn.disabled = false;
        });

        summarizeBtn.addEventListener('click', async () => {
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modal.querySelector('div').classList.remove('scale-95');
            modalContent.innerHTML = '<p>Analizando el contrato y generando resumen...</p>';

            const nombreCliente = document.getElementById('nombre-cliente').value || "No especificado";
            const servicios = [];
            document.querySelectorAll('#servicios-table tbody tr').forEach(row => {
                const servicio = row.cells[0].textContent.trim();
                const costo = row.cells[1].textContent.trim();
                if (servicio) servicios.push(`${servicio} (Costo: ${costo})`);
            });

            const prompt = `Actúa como un asistente de ventas de Claro. Basado en los siguientes datos de un contrato, genera un resumen claro, amigable y profesional para explicarle al cliente lo que está contratando. Sé conciso y enfócate en los puntos más importantes.\n\nDatos del Contrato:\n- Cliente: ${nombreCliente}\n- Servicios y Tarifas: ${servicios.join(', ')}\n\nGenera el resumen.`;
            
            const summary = await callGemini(prompt);
            modalContent.textContent = summary;
        });
        
        closeModalBtn.addEventListener('click', () => {
             modal.classList.add('opacity-0', 'pointer-events-none');
             modal.querySelector('div').classList.add('scale-95');
        });

        const performExport = async (type) => {
            const btnPdf = document.getElementById('export-pdf-btn');
            const btnImg = document.getElementById('export-img-btn');
            const element = document.getElementById('contrato-container');
            const elementsToHide = document.querySelectorAll('.no-print');
            
            btnPdf.disabled = true;
            btnImg.disabled = true;
            elementsToHide.forEach(el => el.style.visibility = 'hidden');

            const originalWidth = element.style.width;
            const originalMaxWidth = element.style.maxWidth;
            element.style.width = '1024px'; 
            element.style.maxWidth = '1024px';
            
            const opt = {
                margin: [0.5, 0.4, 0.5, 0.4],
                filename: `Contrato_Claro_Profesional.${type === 'pdf' ? 'pdf' : 'jpeg'}`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true, logging: false, width: 1024 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
                pagebreak:    { mode: ['css', 'legacy'] }
            };

            try {
                if (type === 'pdf') {
                    btnPdf.textContent = 'Generando PDF...';
                    await html2pdf().set(opt).from(element).save();
                } else {
                    btnImg.textContent = 'Generando Imagen...';
                    const canvas = await html2canvas(element, opt.html2canvas);
                    const imgData = canvas.toDataURL(opt.image.type, opt.image.quality);
                    const link = document.createElement('a');
                    link.download = opt.filename;
                    link.href = imgData;
                    link.click();
                }
            } catch (e) {
                 console.error("Export failed:", e);
                 alert("Ocurrió un error durante la exportación.");
            } finally {
                element.style.width = originalWidth;
                element.style.maxWidth = originalMaxWidth;
                elementsToHide.forEach(el => el.style.visibility = 'visible');
                btnPdf.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 2a1 1 0 00-1 1v5.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 8.586V3a1 1 0 00-1-1z" /><path d="M3 13.5a1.5 1.5 0 001.5 1.5h11a1.5 1.5 0 001.5-1.5v-3a1.5 1.5 0 00-3 0V12a1 1 0 11-2 0v-1.5a1.5 1.5 0 00-3 0V12a1 1 0 11-2 0v-1.5a1.5 1.5 0 00-3 0v3z" /></svg> Exportar a PDF`;
                btnImg.textContent = 'Exportar a Imagen';
                btnPdf.disabled = false;
                btnImg.disabled = false;
            }
        };

        document.getElementById('export-pdf-btn').addEventListener('click', () => performExport('pdf'));
        document.getElementById('export-img-btn').addEventListener('click', () => performExport('image'));

        function addRow(tableId) {
            const table = document.getElementById(tableId);
            const tableBody = table.querySelector('tbody');
            const header = table.querySelector('thead tr');
            const cellCount = header.cells.length;
            
            const newRow = document.createElement('tr');
            
            for (let i = 0; i < cellCount; i++) {
                const newCell = newRow.insertCell(i);
                if (header.cells[i].classList.contains('no-print')) {
                    newCell.innerHTML = '<span class="delete-btn" onclick="deleteRow(this)">&times;</span>';
                    newCell.classList.add('text-center', 'no-print');
                } else {
                    newCell.contentEditable = "true";
                     if (tableId === 'tarifas-table' && i === 0) {
                        newCell.classList.add('font-medium', 'bg-gray-50');
                        newCell.textContent = 'Nuevo Cargo';
                    }
                }
            }
            
            const totalRow = (tableId === 'tarifas-table') ? tableBody.querySelector('tr.font-bold') : null;
            if (totalRow) {
                tableBody.insertBefore(newRow, totalRow);
            } else {
                tableBody.appendChild(newRow);
            }
        }

        function deleteRow(btn) {
            if (confirm('¿Estás seguro de que quieres eliminar esta fila?')) {
                const row = btn.parentNode.parentNode;
                row.parentNode.removeChild(row);
            }
        }
    </script>
</body>
</html>
